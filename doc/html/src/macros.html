

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Macros Autocall</title>
<link rel="stylesheet" type="text/css" href="../docitout.css" title="Style">
</head>
<body><div class="hr"></div>

<ul class="menu">

	<li><a href="../docitout-project-summary.html">Overview</a></li>	
	<li><a href="docitout-directory-summary.html">Directory</a></li>	
	<li class="menuSelected">File</li>	
	<li><a href="../docitout-help.html">Help</a></li>	

</ul>
	
	<table cellspacing="0" cellpadding="0" border="0">
		<tr>
			<td style="font-size: 90%" align="right" wrap>SUMMARY :</td>
			<td>
				<ul class="submenu">
								
										
										
											<li><a href="#summary_macro">MACRO</a></li>	
										
											<li><a href="#summary_macro_call">MACRO CALL</a></li>	
									</ul>
			</td>
		</tr>
		<tr>
			<td style="font-size: 90%" align="right" wrap>DETAIL :</td>
			<td>
				<ul class="submenu">			
										
										
										
											<li><a href="#detail_macro">MACRO</a></li>	
									</ul>
			</td>
		</tr>
	</table>

<div class="hr"></div>

<h2>root</h2>
<h1>macros</h1>

Contains macros that are used to make statistical analysis more or less easier, more manageable, and the code in the main script to be cleaner.


	<dl>
	
				<dt><br><b>Author:</b></dt>
	
							<dd>Luke Johnston</dd>
						
					<dt><br><b>Created:</b></dt>
			<dd>Early 2013</dd>
			</dl>

<br>




	
	<br><a name="summary_macro"></a>
	<table class="gtbl" cellpadding="0" cellspacing="0">
		<tr>
			<th colspan="2">Macro Summary</th>
		</tr>

					
			<tr valign="top">
				<td>
					<code><b><a href="#macro1">anova ( category= , numerical= , dsn=&ds , adjust=tukey , by= , where= , outds=_NULL_ , outpdiff=_NULL_ , dcovar= , ccovar= )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANOVA loop Runs an ANOVA and outputs the results into a dataset that can be converted into a nice format that can easily be pushed to LaTeX/pgfplotstable to generate tables in reports or presentations.
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro2">aroc ( y=&dep , x=&indep , ccovar= , dcovar= , dsn=&ds , outds= )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro3">beta_glm ( y=&dep , x=&indep , dcovar= , ccovar= , interactvar= , dsn=&ds , outall=_NULL_ , outcore=_NULL_ , outObs=_NULL_ , outRSq=_NULL_ , outResid=tmp , sigDigits=0.01 , by= )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Runs linear regression, sending the results into output datasets that can be used in LaTeX as tables.
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro4">compareROC ( subset= , indep1= , indep2= , dsn= , outds= )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro5">csvimport ( dataset= , outds=&dataset , dir=../dataset )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Import csv dataset <p> Imports a non-compressed csv (comma separated values) dataset and puts it in the SAS workspace (outds).
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro6">mergeMeansAnova ( meansds= , anovads= , byVar= , byVarNumLevels=_NULL_ , byVarCatLevels=_NULL_ , outds=_NULL_ )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Merge output datasets from the means and anova macros This macro merges the results of the ``means`' and ``anova`' macro, which are datasets, into one dataset with the p-value included for difference between groups.
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro7">nth_ds ( nth_row= , ds= )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro8">oddsratio ( y=&dep , x=&indep , dcovar= , ccovar= , dsn=&ds , outall=_NULL_ , outcore=_NULL_ , outobs=_NULL_ )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
			</tr>
		
	</table>

	<br><a name="summary_macro_call"></a>
	<table class="gtbl" cellpadding="0" cellspacing="0">
		<tr>
			<th colspan="2">Macro Call Summary</th>
		</tr>
		<tr valign="top">
			<td>
				<code>for</code>
			</td>
		</tr>
	</table>




	<br><a name="detail_macro"></a>
	<table class="gtbl" cellpadding="0" cellspacing="0">
		<tr>
			<th colspan="2">Macro Detail</th>
		</tr>
	</table>
	
				
		<a name="macro1"></a>

		<h3>anova</h3>
		<pre>%macro <b>anova ( category= , numerical= , dsn=&ds , adjust=tukey , by= , where= , outds=_NULL_ , outpdiff=_NULL_ , dcovar= , ccovar= )</b>;</pre>
		<dl>
			<dd>ANOVA loop Runs an ANOVA and outputs the results into a dataset that can be converted into a nice format that can easily be pushed to LaTeX/pgfplotstable to generate tables in reports or presentations. <p> An ANCOVA can be run if ccovar or dcovar variables are used (ie. adjusting for confounders).  The output of this macro can be used in conjunction with the %means macro to make into a nice table format with means and SD, etc.</dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>category - Discrete variable (e.g. Sex) on the side of the table.
															</dd>
													<dd>numerical - Continuous variable (e.g. BMI) at the top of table.
															</dd>
													<dd>dsn - Dataset to be used (&ds variable is default).
																 (default value: &ds)
															</dd>
													<dd>adjust - Adjustment made for post-hoc test.
																 (default value: tukey)
															</dd>
													<dd>by - Split the analysis up by a categorical variable
															</dd>
													<dd>where - Subset the data by the where variable
															</dd>
													<dd>outds - Main output that is the purpose for this macro.
																 (default value: _NULL_)
															</dd>
													<dd>outpdiff - Name of output for the between group p-values.
																 (default value: _NULL_)
															</dd>
													<dd>dcovar - If ANCOVA is needed, this is the discrete covariate(s) to adjust for.
															</dd>
													<dd>ccovar - If ANCOVA is needed, this is the continuous covariate(s) to adjust for.
															</dd>
																
											<dt><br><b>Returns:</b></dt>
						<dd>The main output are proc prints of the output datasets outds and outpdiff, though these datasets are by default not output into the SAS workspace.</dd>
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro2"></a>

		<h3>aroc</h3>
		<pre>%macro <b>aroc ( y=&dep , x=&indep , ccovar= , dcovar= , dsn=&ds , outds= )</b>;</pre>
		<dl>
			<dd></dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>y - 
																 (default value: &dep)
															</dd>
													<dd>x - 
																 (default value: &indep)
															</dd>
													<dd>ccovar - 
															</dd>
													<dd>dcovar - 
															</dd>
													<dd>dsn - 
																 (default value: &ds)
															</dd>
													<dd>outds - 
															</dd>
																
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro3"></a>

		<h3>beta_glm</h3>
		<pre>%macro <b>beta_glm ( y=&dep , x=&indep , dcovar= , ccovar= , interactvar= , dsn=&ds , outall=_NULL_ , outcore=_NULL_ , outObs=_NULL_ , outRSq=_NULL_ , outResid=tmp , sigDigits=0.01 , by= )</b>;</pre>
		<dl>
			<dd>Runs linear regression, sending the results into output datasets that can be used in LaTeX as tables.  In this macro, there are two loops going on.  This allows any number of exposures and outcomes to be specified in the macro, running regressions on each outcome with each exposure.  This is allows the code to be cleaner, leaner, more efficient, and more maintainable. <p> The loops work in a combinatoric fashion, starting with the `y`, or dependent variable, then going through each of the `x` variables.  For instance, I want to run a regression on BMI and dietary fat with insulin resistance and blood lipids.  The `y` variable would have insulin resistance and blood lipids, while the `x` would have BMI and dietary fat.  The macro would run insulin resistance with BMI, then insulin resistance with dietary fat, then blood lipids and BMI and so on. <p> All output datasets are optional as each of the dataset variables are set to _NULL_.  The results datasets that can be output are the beta and standard error (plus p-value), the $R^2$, and the sample size. <p> Each variable, except for the dataset variables, can have multiple variables included, each separated by a space, not a comma. <p> As a reminder (for using the below variables), the linear regression equation is: y = B_0 + B_1 x_1 + ... + B_n x_n + e</dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>y - Dependent, or outcome, variable
																 (default value: &dep)
															</dd>
													<dd>x - Independent, or exposure, variable
																 (default value: &indep)
															</dd>
													<dd>dcovar - Discrete covariates included in the model (i.e. Sex)
															</dd>
													<dd>ccovar - Continuous covariates in the model (i.e. Age)
															</dd>
													<dd>interactvar - The <b>discrete</b> interaction term (i.e. Sex)
															</dd>
													<dd>dsn - Name of the dataset to analyze
																 (default value: &ds)
															</dd>
													<dd>outall - Dataset with all the betas, SE of each variable in the model
																 (default value: _NULL_)
															</dd>
													<dd>outcore - Dataset with only the betas, SE for the `x` variables
																 (default value: _NULL_)
															</dd>
													<dd>outObs - Dataset with the sample size used in each model
																 (default value: _NULL_)
															</dd>
													<dd>outRSq - Dataset with the $R^2$ for the model
																 (default value: _NULL_)
															</dd>
													<dd>outResid - Dataset that contains the raw and studentized residuals
																 (default value: tmp)
															</dd>
													<dd>sigDigits - 
																 (default value: 0.01)
															</dd>
													<dd>by - 
															</dd>
																
											<dt><br><b>Returns:</b></dt>
						<dd>The results of `outcore`, `outObs`, and `outRSq` are printed, but by default no datasets are output, unless specified.</dd>
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro4"></a>

		<h3>compareROC</h3>
		<pre>%macro <b>compareROC ( subset= , indep1= , indep2= , dsn= , outds= )</b>;</pre>
		<dl>
			<dd></dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>subset - 
															</dd>
													<dd>indep1 - 
															</dd>
													<dd>indep2 - 
															</dd>
													<dd>dsn - 
															</dd>
													<dd>outds - 
															</dd>
																
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro5"></a>

		<h3>csvimport</h3>
		<pre>%macro <b>csvimport ( dataset= , outds=&dataset , dir=../dataset )</b>;</pre>
		<dl>
			<dd>Import csv dataset <p> Imports a non-compressed csv (comma separated values) dataset and puts it in the SAS workspace (outds).</dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>dataset - Input dataset
															</dd>
													<dd>outds - Output dataset
																 (default value: &dataset)
															</dd>
													<dd>dir - Directory where the input dataset is located
																 (default value: ../dataset)
															</dd>
																
											<dt><br><b>Returns:</b></dt>
						<dd>Outputs the csv dataset into the SAS workspace</dd>
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro6"></a>

		<h3>mergeMeansAnova</h3>
		<pre>%macro <b>mergeMeansAnova ( meansds= , anovads= , byVar= , byVarNumLevels=_NULL_ , byVarCatLevels=_NULL_ , outds=_NULL_ )</b>;</pre>
		<dl>
			<dd>Merge output datasets from the means and anova macros This macro merges the results of the ``means`' and ``anova`' macro, which are datasets, into one dataset with the p-value included for difference between groups.  The output for the means needs to have had an argument for the by variable (``by=`'), so that the means dataset can be transformed from long to wide.  The variables from both the ``means`' and the ``anova`' macro need to be in the same order/sequence.</dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>meansds - Output dataset from the ``means`' macro, needs to be the first argument
															</dd>
													<dd>anovads - Output dataset from the ``anova`' macro, has to be the second argument
															</dd>
													<dd>byVar - The categorical (or discrete/binary number, such as for an order) variable that was used to group both the anova and the means datasets
															</dd>
													<dd>byVarNumLevels - The levels of the discrete/binary number ``byVar`', such as 0 1, 0 1 2 3, etc
																 (default value: _NULL_)
															</dd>
													<dd>byVarCatLevels - The levels of the categorical ``byVar`', such as Yes No or Female Male
																 (default value: _NULL_)
															</dd>
													<dd>outds - Optional as the output dataset will be named after the ``means`' dataset
																 (default value: _NULL_)
															</dd>
																
											<dt><br><b>Returns:</b></dt>
						<dd>Outputs a dataset with the merged means and p-values for differences between groups</dd>
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro7"></a>

		<h3>nth_ds</h3>
		<pre>%macro <b>nth_ds ( nth_row= , ds= )</b>;</pre>
		<dl>
			<dd></dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>nth_row - 
															</dd>
													<dd>ds - 
															</dd>
																
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro8"></a>

		<h3>oddsratio</h3>
		<pre>%macro <b>oddsratio ( y=&dep , x=&indep , dcovar= , ccovar= , dsn=&ds , outall=_NULL_ , outcore=_NULL_ , outobs=_NULL_ )</b>;</pre>
		<dl>
			<dd></dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>y - 
																 (default value: &dep)
															</dd>
													<dd>x - 
																 (default value: &indep)
															</dd>
													<dd>dcovar - 
															</dd>
													<dd>ccovar - 
															</dd>
													<dd>dsn - 
																 (default value: &ds)
															</dd>
													<dd>outall - 
																 (default value: _NULL_)
															</dd>
													<dd>outcore - 
																 (default value: _NULL_)
															</dd>
													<dd>outobs - 
																 (default value: _NULL_)
															</dd>
																
									</dl>
			</dd>
		</dl>

			



<br><br>

<div class="hr"></div>

<ul class="menu">

	<li><a href="../docitout-project-summary.html">Overview</a></li>	
	<li><a href="docitout-directory-summary.html">Directory</a></li>	
	<li class="menuSelected">File</li>	
	<li><a href="../docitout-help.html">Help</a></li>	

</ul>
	
	<table cellspacing="0" cellpadding="0" border="0">
		<tr>
			<td style="font-size: 90%" align="right" wrap>SUMMARY :</td>
			<td>
				<ul class="submenu">
								
										
										
											<li><a href="#summary_macro">MACRO</a></li>	
										
											<li><a href="#summary_macro_call">MACRO CALL</a></li>	
									</ul>
			</td>
		</tr>
		<tr>
			<td style="font-size: 90%" align="right" wrap>DETAIL :</td>
			<td>
				<ul class="submenu">			
										
										
										
											<li><a href="#detail_macro">MACRO</a></li>	
									</ul>
			</td>
		</tr>
	</table>

<div class="hr"></div>

<table width="100%">
	<tr valign="top">
		<td align="left" width="50%">Last updated on October 26, 2014</td>
		<td align="right" width="50%">
			Powered by 
			<a href="http://choonchernlim.com/docitout/" target="_blank">
				<img src="../logo.png" align="top" border="0">
			</a>
		</td>
	</tr>
</table></body>
</html>
