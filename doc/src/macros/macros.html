

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Macro Library</title>
<link rel="stylesheet" type="text/css" href="../../docitout.css" title="Style">
</head>
<body><div class="hr"></div>

<ul class="menu">

	<li><a href="../../docitout-project-summary.html">Overview</a></li>	
	<li><a href="docitout-directory-summary.html">Directory</a></li>	
	<li class="menuSelected">File</li>	
	<li><a href="../../docitout-help.html">Help</a></li>	

</ul>
	
	<table cellspacing="0" cellpadding="0" border="0">
		<tr>
			<td style="font-size: 90%" align="right" wrap>SUMMARY :</td>
			<td>
				<ul class="submenu">
								
										
										
											<li><a href="#summary_macro">MACRO</a></li>	
										
											<li><a href="#summary_macro_call">MACRO CALL</a></li>	
									</ul>
			</td>
		</tr>
		<tr>
			<td style="font-size: 90%" align="right" wrap>DETAIL :</td>
			<td>
				<ul class="submenu">			
										
										
										
											<li><a href="#detail_macro">MACRO</a></li>	
									</ul>
			</td>
		</tr>
	</table>

<div class="hr"></div>

<h2>root/macros</h2>
<h1>macros</h1>

Contains macros that are used to make statistical analysis more or less easier, more manageable, and the code in the main script to be cleaner.


	<dl>
	
				<dt><br><b>Author:</b></dt>
	
							<dd>Luke Johnston</dd>
						
					<dt><br><b>Created:</b></dt>
			<dd>Early 2013</dd>
			</dl>

<br>




	
	<br><a name="summary_macro"></a>
	<table class="gtbl" cellpadding="0" cellspacing="0">
		<tr>
			<th colspan="2">Macro Summary</th>
		</tr>

					
			<tr valign="top">
				<td>
					<code><b><a href="#macro1">anova ( category= , numerical= , dsn=&ds , adjust=tukey , outds=_NULL_ , outpdiff=_NULL_ , dcovar= , ccovar= )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Runs an ANOVA and outputs the results into a nice format that can easily be pushed to LaTeX/pgfplotstable to be generated into tables in reports or presentations.
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro2">aroc ( y=&dep , x=&indep , ccovar= , dcovar= , dsn=&ds , outds= )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro3">beta_glm ( y=&dep , x=&indep , dcovar= , ccovar= , interactvar= , dsn=&ds , outall=_NULL_ , outcore=_NULL_ , outObs=_NULL_ , outRSq=_NULL_ , outResid=tmp , sigDigits=0.01 )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Runs linear regression, sending the results into output datasets that can be used in LaTeX as tables.
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro4">compareROC ( subset= , indep1= , indep2= , dsn= , outds= )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro5">contents ( dataset= , lib=work )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro6">correlation ( rowvar= , colvar= , covar= , outds= , coeff_test=Spearman , dsn=&ds )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro7">csvgz_import ( dataset= , outds=&dataset , dir=../dataset )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro8">csvimport ( dataset= , outds=&dataset , dir=../dataset )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro9">discr_means ( discrete= )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro10">freq ( vars= , dsn=&ds , outds=_NULL_ )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Macro for frequencies of categorical/discrete variables.
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro11">means ( vars= , by= , class= , outds=_NULL_ , dsn=&ds )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Macro to generate univariate (or divariate if a class variable is specified) means of continuous variables.
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro12">nth_ds ( nth_row= , ds= )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro13">oddsratio ( y=&dep , x=&indep , dcovar= , ccovar= , dsn=&ds , outall=_NULL_ , outcore=_NULL_ , outobs=_NULL_ )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro14">output_data ( dataset= , dir=../output )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Macro to output a dataset to a csv file in a specified directory (i.
				</td>
			</tr>
					
			<tr valign="top">
				<td>
					<code><b><a href="#macro15">pca ( vars= , dsn=&ds , n= , opt_rotate=none , pcname= , varlabel= , outeig=_NULL_ , outpattern=_NULL_ , outrotpat=_NULL_ , outvariance=_NULL_ )</a></b></code>
					<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
				</td>
			</tr>
		
	</table>

	<br><a name="summary_macro_call"></a>
	<table class="gtbl" cellpadding="0" cellspacing="0">
		<tr>
			<th colspan="2">Macro Call Summary</th>
		</tr>
		<tr valign="top">
			<td>
				<code>csvimport, for, means</code>
			</td>
		</tr>
	</table>




	<br><a name="detail_macro"></a>
	<table class="gtbl" cellpadding="0" cellspacing="0">
		<tr>
			<th colspan="2">Macro Detail</th>
		</tr>
	</table>
	
				
		<a name="macro1"></a>

		<h3>anova</h3>
		<pre>%macro <b>anova ( category= , numerical= , dsn=&ds , adjust=tukey , outds=_NULL_ , outpdiff=_NULL_ , dcovar= , ccovar= )</b>;</pre>
		<dl>
			<dd>Runs an ANOVA and outputs the results into a nice format that can easily be pushed to LaTeX/pgfplotstable to be generated into tables in reports or presentations. <p> There are loops in this macro, such that the variables on the side of the output ("category") are looped by the header variable (top of the output, "numerical").  For example, I want an output to eventually use as a table, with BMI and waist as the columns and sex and ethnicity on the side as rows.  Sex and ethnicity get looped by BMI first, then sex and ethnicity get looped by waist next.  This way, BMI will be the first column of results and waist will be the next column of results. <p> In addition, the output are formatted in a way to not need to manipulate the results in any way to fit as a table in a manuscript or presentations. For instance, means and standard deviations are output as a single column (as "mean (SD)"), when before they were two columns.</dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>category - Discrete variable (e.g. Sex) on the side of the table.
															</dd>
													<dd>numerical - Continuous variable (e.g. BMI) at the top of table.
															</dd>
													<dd>dsn - Dataset to be used (&ds variable is default).
																 (default value: &ds)
															</dd>
													<dd>adjust - Adjustment made for post-hoc test.
																 (default value: tukey)
															</dd>
													<dd>outds - Main output that is the purpose for this macro.
																 (default value: _NULL_)
															</dd>
													<dd>outpdiff - Name of output for the between group p-values.
																 (default value: _NULL_)
															</dd>
													<dd>dcovar - If ANCOVA is needed, this is the discrete covariate(s) to adjust for.
															</dd>
													<dd>ccovar - If ANCOVA is needed, this is the continuous covariate(s) to adjust for.
															</dd>
																
											<dt><br><b>Returns:</b></dt>
						<dd>The main output are proc prints of the output datasets outds and outpdiff, though these datasets are by default not output into the SAS workspace.</dd>
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro2"></a>

		<h3>aroc</h3>
		<pre>%macro <b>aroc ( y=&dep , x=&indep , ccovar= , dcovar= , dsn=&ds , outds= )</b>;</pre>
		<dl>
			<dd></dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>y - 
																 (default value: &dep)
															</dd>
													<dd>x - 
																 (default value: &indep)
															</dd>
													<dd>ccovar - 
															</dd>
													<dd>dcovar - 
															</dd>
													<dd>dsn - 
																 (default value: &ds)
															</dd>
													<dd>outds - 
															</dd>
																
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro3"></a>

		<h3>beta_glm</h3>
		<pre>%macro <b>beta_glm ( y=&dep , x=&indep , dcovar= , ccovar= , interactvar= , dsn=&ds , outall=_NULL_ , outcore=_NULL_ , outObs=_NULL_ , outRSq=_NULL_ , outResid=tmp , sigDigits=0.01 )</b>;</pre>
		<dl>
			<dd>Runs linear regression, sending the results into output datasets that can be used in LaTeX as tables.  In this macro, there are two loops going on.  This allows any number of exposures and outcomes to be specified in the macro, running regressions on each outcome with each exposure.  This is allows the code to be cleaner, leaner, more efficient, and more maintainable. <p> The loops work in a combinatoric fashion, starting with the `y`, or dependent variable, then going through each of the `x` variables.  For instance, I want to run a regression on BMI and dietary fat with insulin resistance and blood lipids.  The `y` variable would have insulin resistance and blood lipids, while the `x` would have BMI and dietary fat.  The macro would run insulin resistance with BMI, then insulin resistance with dietary fat, then blood lipids and BMI and so on. <p> All output datasets are optional as each of the dataset variables are set to _NULL_.  The results datasets that can be output are the beta and standard error (plus p-value), the $R^2$, and the sample size. <p> Each variable, except for the dataset variables, can have multiple variables included, each separated by a space, not a comma. <p> As a reminder (for using the below variables), the linear regression equation is: y = B_0 + B_1 x_1 + ... + B_n x_n + e</dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>y - Dependent, or outcome, variable
																 (default value: &dep)
															</dd>
													<dd>x - Independent, or exposure, variable
																 (default value: &indep)
															</dd>
													<dd>dcovar - Discrete covariates included in the model (i.e. Sex)
															</dd>
													<dd>ccovar - Continuous covariates in the model (i.e. Age)
															</dd>
													<dd>interactvar - The <b>discrete</b> interaction term (i.e. Sex)
															</dd>
													<dd>dsn - Name of the dataset to analyze
																 (default value: &ds)
															</dd>
													<dd>outall - Dataset with all the betas, SE of each variable in the model
																 (default value: _NULL_)
															</dd>
													<dd>outcore - Dataset with only the betas, SE for the `x` variables
																 (default value: _NULL_)
															</dd>
													<dd>outObs - Dataset with the sample size used in each model
																 (default value: _NULL_)
															</dd>
													<dd>outRSq - Dataset with the $R^2$ for the model
																 (default value: _NULL_)
															</dd>
													<dd>outResid - Dataset that contains the raw and studentized residuals
																 (default value: tmp)
															</dd>
													<dd>sigDigits - 
																 (default value: 0.01)
															</dd>
																
											<dt><br><b>Returns:</b></dt>
						<dd>The results of `outcore`, `outObs`, and `outRSq` are printed, but by default no datasets are output, unless specified.</dd>
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro4"></a>

		<h3>compareROC</h3>
		<pre>%macro <b>compareROC ( subset= , indep1= , indep2= , dsn= , outds= )</b>;</pre>
		<dl>
			<dd></dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>subset - 
															</dd>
													<dd>indep1 - 
															</dd>
													<dd>indep2 - 
															</dd>
													<dd>dsn - 
															</dd>
													<dd>outds - 
															</dd>
																
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro5"></a>

		<h3>contents</h3>
		<pre>%macro <b>contents ( dataset= , lib=work )</b>;</pre>
		<dl>
			<dd></dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>dataset - 
															</dd>
													<dd>lib - 
																 (default value: work)
															</dd>
																
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro6"></a>

		<h3>correlation</h3>
		<pre>%macro <b>correlation ( rowvar= , colvar= , covar= , outds= , coeff_test=Spearman , dsn=&ds )</b>;</pre>
		<dl>
			<dd></dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>rowvar - 
															</dd>
													<dd>colvar - 
															</dd>
													<dd>covar - 
															</dd>
													<dd>outds - 
															</dd>
													<dd>coeff_test - 
																 (default value: Spearman)
															</dd>
													<dd>dsn - 
																 (default value: &ds)
															</dd>
																
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro7"></a>

		<h3>csvgz_import</h3>
		<pre>%macro <b>csvgz_import ( dataset= , outds=&dataset , dir=../dataset )</b>;</pre>
		<dl>
			<dd></dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>dataset - 
															</dd>
													<dd>outds - 
																 (default value: &dataset)
															</dd>
													<dd>dir - 
																 (default value: ../dataset)
															</dd>
																
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro8"></a>

		<h3>csvimport</h3>
		<pre>%macro <b>csvimport ( dataset= , outds=&dataset , dir=../dataset )</b>;</pre>
		<dl>
			<dd></dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>dataset - 
															</dd>
													<dd>outds - 
																 (default value: &dataset)
															</dd>
													<dd>dir - 
																 (default value: ../dataset)
															</dd>
																
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro9"></a>

		<h3>discr_means</h3>
		<pre>%macro <b>discr_means ( discrete= )</b>;</pre>
		<dl>
			<dd></dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>discrete - 
															</dd>
																
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro10"></a>

		<h3>freq</h3>
		<pre>%macro <b>freq ( vars= , dsn=&ds , outds=_NULL_ )</b>;</pre>
		<dl>
			<dd>Macro for frequencies of categorical/discrete variables.  Only does univariate frequencies.</dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>vars - Discrete variables to analyze
															</dd>
													<dd>dsn - Name of dataset to analyze
																 (default value: &ds)
															</dd>
													<dd>outds - Results dataset to output
																 (default value: _NULL_)
															</dd>
																
											<dt><br><b>Returns:</b></dt>
						<dd>Only prints the results by default, but does output a dataset if specified</dd>
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro11"></a>

		<h3>means</h3>
		<pre>%macro <b>means ( vars= , by= , class= , outds=_NULL_ , dsn=&ds )</b>;</pre>
		<dl>
			<dd>Macro to generate univariate (or divariate if a class variable is specified) means of continuous variables.  It compresses the mean + SD and the median + IQR into one column/variable.</dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>vars - Continuous variables to determine the mean
															</dd>
													<dd>by - I haven't tested this option yet.  It may not work
															</dd>
													<dd>class - Can do the means of a variable by a discrete variable
															</dd>
													<dd>outds - Dataset to output results to
																 (default value: _NULL_)
															</dd>
													<dd>dsn - The name of the input dataset to use
																 (default value: &ds)
															</dd>
																
											<dt><br><b>Returns:</b></dt>
						<dd>Returns a proc print of the results by default, but outputs a dataset if specified.</dd>
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro12"></a>

		<h3>nth_ds</h3>
		<pre>%macro <b>nth_ds ( nth_row= , ds= )</b>;</pre>
		<dl>
			<dd></dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>nth_row - 
															</dd>
													<dd>ds - 
															</dd>
																
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro13"></a>

		<h3>oddsratio</h3>
		<pre>%macro <b>oddsratio ( y=&dep , x=&indep , dcovar= , ccovar= , dsn=&ds , outall=_NULL_ , outcore=_NULL_ , outobs=_NULL_ )</b>;</pre>
		<dl>
			<dd></dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>y - 
																 (default value: &dep)
															</dd>
													<dd>x - 
																 (default value: &indep)
															</dd>
													<dd>dcovar - 
															</dd>
													<dd>ccovar - 
															</dd>
													<dd>dsn - 
																 (default value: &ds)
															</dd>
													<dd>outall - 
																 (default value: _NULL_)
															</dd>
													<dd>outcore - 
																 (default value: _NULL_)
															</dd>
													<dd>outobs - 
																 (default value: _NULL_)
															</dd>
																
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro14"></a>

		<h3>output_data</h3>
		<pre>%macro <b>output_data ( dataset= , dir=../output )</b>;</pre>
		<dl>
			<dd>Macro to output a dataset to a csv file in a specified directory (i.e. a folder).  It also suppresses double quotes. <p> <b>Examples:</b> <p> <code> proc means;<br> ods output summary=means;<br> run;<br> <p> %output_data(dataset=means, dir=./output);<br> </code></dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>dataset - Results output dataset to print to csv
															</dd>
													<dd>dir - Directory where the results will be output to
																 (default value: ../output)
															</dd>
																
											<dt><br><b>Returns:</b></dt>
						<dd>Outputs a csv file to a specified directory</dd>
									</dl>
			</dd>
		</dl>

					<div class="hr"></div>
					
		<a name="macro15"></a>

		<h3>pca</h3>
		<pre>%macro <b>pca ( vars= , dsn=&ds , n= , opt_rotate=none , pcname= , varlabel= , outeig=_NULL_ , outpattern=_NULL_ , outrotpat=_NULL_ , outvariance=_NULL_ )</b>;</pre>
		<dl>
			<dd></dd>
			<dd>
				<dl>
											<dt><br><b>Parameters:</b></dt>
							
													<dd>vars - 
															</dd>
													<dd>dsn - 
																 (default value: &ds)
															</dd>
													<dd>n - 
															</dd>
													<dd>opt_rotate - 
																 (default value: none)
															</dd>
													<dd>pcname - 
															</dd>
													<dd>varlabel - 
															</dd>
													<dd>outeig - 
																 (default value: _NULL_)
															</dd>
													<dd>outpattern - 
																 (default value: _NULL_)
															</dd>
													<dd>outrotpat - 
																 (default value: _NULL_)
															</dd>
													<dd>outvariance - 
																 (default value: _NULL_)
															</dd>
																
									</dl>
			</dd>
		</dl>

			



<br><br>

<div class="hr"></div>

<ul class="menu">

	<li><a href="../../docitout-project-summary.html">Overview</a></li>	
	<li><a href="docitout-directory-summary.html">Directory</a></li>	
	<li class="menuSelected">File</li>	
	<li><a href="../../docitout-help.html">Help</a></li>	

</ul>
	
	<table cellspacing="0" cellpadding="0" border="0">
		<tr>
			<td style="font-size: 90%" align="right" wrap>SUMMARY :</td>
			<td>
				<ul class="submenu">
								
										
										
											<li><a href="#summary_macro">MACRO</a></li>	
										
											<li><a href="#summary_macro_call">MACRO CALL</a></li>	
									</ul>
			</td>
		</tr>
		<tr>
			<td style="font-size: 90%" align="right" wrap>DETAIL :</td>
			<td>
				<ul class="submenu">			
										
										
										
											<li><a href="#detail_macro">MACRO</a></li>	
									</ul>
			</td>
		</tr>
	</table>

<div class="hr"></div>

<table width="100%">
	<tr valign="top">
		<td align="left" width="50%">Last updated on June 06, 2014</td>
		<td align="right" width="50%">
			Powered by 
			<a href="http://choonchernlim.com/docitout/" target="_blank">
				<img src="../../logo.png" align="top" border="0">
			</a>
		</td>
	</tr>
</table></body>
</html>
